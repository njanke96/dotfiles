#!/bin/sh

# Background wallpapers
swaybg -o DP-1 -i /home/nathan/Pictures/wallpapers/gruvmoon.png &
swaybg -o DP-3 -i /home/nathan/Pictures/wallpapers/gruvmoon.png -m fill &

# Pipewire
pipewire &

# XFCE polkit
/usr/libexec/xfce-polkit &

# XFsettingsd
# 
# Unfortunately this uses xfce settings for wayland display config,
# even though at this time I would rather use kanshi
#
# I still need this for some panel functionality
xfsettingsd &

# xfce notifications, works perfectly
/usr/lib64/xfce4/notifyd/xfce4-notifyd &

# XFCE Panel
xfce4-panel &

# audio idle inhibit (blocks loginctl suspend when audio is playing)
# points to a script that just runs sway-audio-idle-inhibit in a loop in case
# it crashes
/home/nathan/scripts/saii.sh &

# conky (also often crashes)
/home/nathan/scripts/conky.sh &

# swaylock until xfce power manager has better wayland support
swayidle -w timeout 900 'loginctl suspend' &

# run the after resume script now
# to run on resume it must also be called as 'nathan' via /etc/elogind/system-sleep/post-sleep.sh (if [ "$1" = "post" ], see loginctl(1))
/home/nathan/scripts/on-resume.sh &

# sleep before starting applications (mostly for pipewire to finish starting)
# (there is definitely a better solution for this)
sleep 5

# blueman applet
blueman-applet &

# start discord
/usr/bin/flatpak run --branch=stable --arch=x86_64 \
  --command=com.discordapp.Discord \
  --file-forwarding com.discordapp.Discord &

